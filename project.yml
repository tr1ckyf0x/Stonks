name: "Stonks"

settings:
  base:
    DEBUG_INFORMATION_FORMAT: dwarf-with-dsym
    CLANG_ANALYZER_LOCALIZABILITY_NONLOCALIZED: YES
    CLANG_ANALYZER_LOCALIZABILITY_EMPTY_CONTEXT: YES
    CLANG_WARN_QUOTED_INCLUDE_IN_FRAMEWORK_HEADER: YES
    ENABLE_HARDENED_RUNTIME: YES
    DEVELOPMENT_TEAM: SGM5527A99
    CODE_SIGN_STYLE: Automatic
    MARKETING_VERSION: 1.0
    CURRENT_PROJECT_VERSION: 1.0

options:
  deploymentTarget:
    macOS: 12.0
  preGenCommand: ./Scripts/autogenerated_files.sh

attributes:
  ORGANIZATIONNAME: "Vladislav Lisianskii"

packages:
  # Local packages

  ## Core
  STNetworking:
    path: Packages/STNetworking
    group: Core

  CoinMarketProvider:
    path: Packages/CoinMarketProvider
    group: Core

  Models:
    path: Packages/Models
    group: Core

  KeychainService:
    path: Packages/KeychainService
    group: Core

  ## UI
  SharedResources:
    path: Packages/SharedResources
    group: UI

targets:
  Stonks:
    platform: macOS
    type: application
    sources:
      - path: "Stonks"
        excludes:
          - "swiftgen.yml"
    dependencies:
      - target: StonksWidget
      - package: KeychainService

    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: com.tr1ckyf0x.stonks
        CODE_SIGN_ENTITLEMENTS: "Stonks/Resources/Stonks.entitlements"
        DEVELOPMENT_ASSET_PATHS: "\"Stonks/Preview Content\""
        ENABLE_PREVIEWS: YES

  StonksWidget:
    platform: macOS
    type: app-extension
    sources:
      - path: StonksWidget
        excludes:
          - "swiftgen.yml"
    dependencies:
      - package: SharedResources
      - package: CoinMarketProvider
      - package: STNetworking
      - package: KeychainService
    settings:
      base:
        PRODUCT_BUNDLE_IDENTIFIER: com.tr1ckyf0x.stonks.widget
        CODE_SIGN_ENTITLEMENTS: "StonksWidget/StonksWidget.entitlements"
        OTHER_LDFLAGS: $(inherited) -framework WidgetKit -framework SwiftUI
